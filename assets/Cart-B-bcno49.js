import{Q as x}from"./QImg-DMU2ZDiy.js";import{Q as V,a as Y,b,c as g}from"./QList-gKmmj6SL.js";import{d as A,t as L,u as R,v as z,c as O,r as j,S as D,i as e,y as c,w as t,A as y,b as k,z as I,F as S,e as u,B as f,R as Q,U as B,f as a,D as n,V as v,j as C,p as G,k as M,_ as E}from"./index-C5q-uV_y.js";import{Q as H}from"./QBtnGroup-CyseMwMy.js";import{Q as K}from"./QPage-Bw-uGZRa.js";const X=""+new URL("PepeBugFly-fXrYNeKG.png",import.meta.url).href,w=h=>(G("data-v-093c9b51"),h=h(),M(),h),J=w(()=>u("h5",{class:"page-title"},"🛒Shopping Cart ",-1)),W=w(()=>u("div",{style:{"font-size":"1rem","margin-bottom":"1rem","text-align":"center"}},"Here is the product you order. 🍳",-1)),Z={class:"normal-font q-mb-sm"},ee={key:1,class:"text-h6 q-pa-md text-center text-color text-color-primary"},te={class:"btn-container"},ae={key:3,class:"row justify-between items-center q-mt-md"},oe={class:"row no-wrap items-center"},re=w(()=>u("div",{class:"q-mr-sm text-base"},"Checkout",-1)),se={class:"q-ml-sm text-base"},ce=A({__name:"Cart",setup(h){const _=L(),l=R(),{cart:i}=z(l),F=O(()=>l.cartTotal),q=j(!1),p=D(),N=r=>{const s=i.value[r];l.updateCartItemQuantity(r,s.quantity+1)},$=r=>{const s=i.value[r];s.quantity>1?l.updateCartItemQuantity(r,s.quantity-1):l.removeFromCart(r)},P=()=>{p.dialog({title:"Confirm",message:"Are you sure you want to clear your cart?",ok:{label:"Yes",color:"primary"},cancel:{label:"No",color:"primary",outline:!0},persistent:!0}).onOk(()=>{l.clearCart(),p.notify({color:"secondary",message:"Cart cleared successfully!"})}).onCancel(()=>{})},U=async()=>{q.value=!0;try{await l.checkout(),_.push("/order-history")}catch{p.notify({color:"accent",message:"Failed to place order. Please try again."})}finally{q.value=!1}},T=async()=>{(await p.dialog({title:"Confirmation",message:"Are you sure you want to proceed with checkout?",ok:{label:"Yes",color:"primary",outline:!1},cancel:{label:"No",color:"primary",outline:!0},persistent:!0})).onOk(async()=>{var o;if(!p.cookies.get("token")){v.create({type:"negative",color:"accent",message:"You are not logged in yet. Please login first."}),_.push({path:"/user",query:{from:"/cart"}});return}try{await U(),v.create({type:"positive",message:"Checkout successful!"}),_.push("/order-history")}catch(d){((o=d.response)==null?void 0:o.status)===401?(v.create({color:"accent",type:"negative",message:"Unauthorized. Please log in again."}),_.push("/user")):v.create({color:"accent",type:"negative",message:d.message||"An error occurred during checkout."})}})};return(r,s)=>(e(),c(K,{class:"q-pa-md"},{default:t(()=>[J,W,y(i).length?(e(),c(V,{key:0,bordered:"",separator:"",class:"rounded-borders"},{default:t(()=>[(e(!0),k(S,null,I(y(i),(o,d)=>(e(),c(Y,{key:d,class:"q-py-md"},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[o.photoUrl?(e(),c(x,{key:0,src:o.photoUrl,style:{width:"100px",height:"100px"},ratio:1,class:"rounded-borders"},null,8,["src"])):(e(),c(x,{key:1,src:X}))]),_:2},1024),a(b,null,{default:t(()=>[a(g,{class:"item-name"},{default:t(()=>[C(n(o.name),1)]),_:2},1024),a(g,{caption:""},{default:t(()=>[C(" Unit: $"+n(o.price.toFixed(2)),1)]),_:2},1024),(e(!0),k(S,null,I(o.selectedOptions,m=>(e(),c(g,{key:m.category,caption:""},{default:t(()=>[C(n(m.category)+": "+n(m.option)+" (+$"+n(m.additionalPrice.toFixed(2))+") ",1)]),_:2},1024))),128)),a(g,{caption:""},{default:t(()=>[C(" Total: $"+n(o.totalPrice.toFixed(2)),1)]),_:2},1024)]),_:2},1024),a(b,{side:""},{default:t(()=>[u("div",Z," Quantity: "+n(o.quantity),1),a(H,{spread:""},{default:t(()=>[a(f,{flat:"",color:"secondary",icon:"remove",onClick:m=>$(d)},null,8,["onClick"]),a(f,{flat:"",color:"primary",icon:"add",onClick:m=>N(d)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(e(),k("div",ee," Your cart is empty now. ")),u("div",te,[y(i).length?Q("",!0):(e(),c(f,{key:0,color:"primary",label:"Buy Now 🤩",onClick:s[0]||(s[0]=o=>r.$router.push("/menu")),class:"cta-button"}))]),y(i).length?(e(),c(B,{key:2,class:"q-my-md"})):Q("",!0),y(i).length?(e(),k("div",ae,[a(f,{outline:"",class:"clear-cart",label:"Clear Cart",onClick:P}),a(f,{color:"primary",onClick:T,class:"cta-button"},{default:t(()=>[u("div",oe,[re,a(B,{vertical:"",inset:"",color:"white"}),u("div",se,"$"+n(Math.ceil(F.value).toFixed(2)),1)])]),_:1})])):Q("",!0)]),_:1}))}}),me=E(ce,[["__scopeId","data-v-093c9b51"]]);export{me as default};
