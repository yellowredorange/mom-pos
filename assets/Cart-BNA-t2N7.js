import{d as N,y as P,a as V,s as T,c as U,U as M,V as O,f as a,j as i,w as o,i as m,t as r,k as y,g as f,A as Q,l as s,B as $,m as g,F as q,D as h,S as v,W as w,_ as R}from"./index-Cxya-pB3.js";import{Q as j,a as x,b as C,c as k}from"./QList-DpV8FpEk.js";import{Q as z}from"./QBtnGroup-Dl8Wj47v.js";import{Q as A}from"./QPage-DQWCz8DX.js";const E=""+new URL("PepeBugFly-fXrYNeKG.png",import.meta.url).href,G={class:"page-title"},K={style:{"font-size":"1rem","margin-bottom":"1rem","text-align":"center"}},W={class:"normal-font q-mb-sm"},X={key:1,class:"text-h6 q-pa-md text-center text-color text-color-primary"},Y={class:"btn-container"},H={key:3,class:"row justify-between items-center q-mt-md"},J={class:"row no-wrap items-center"},Z={class:"q-mr-sm text-base"},ee={class:"q-ml-sm text-base"},te=N({__name:"Cart",setup(ae){const _=P(),u=V(),{cart:d}=T(u),I=U(()=>u.cartTotal),c=M(),{t}=O(),B=e=>{const n=d.value[e];u.updateCartItemQuantity(e,n.quantity+1)},F=e=>{const n=d.value[e];n.quantity>1?u.updateCartItemQuantity(e,n.quantity-1):u.removeFromCart(e)},D=()=>{c.dialog({title:t("confirm"),message:t("clearCartMessage"),ok:{label:t("yes"),color:"primary"},cancel:{label:t("no"),color:"primary",outline:!0},persistent:!0}).onOk(()=>{u.clearCart(),c.notify({color:"secondary",message:t("cartCleared")})}).onCancel(()=>{})},S=async()=>{var e;try{await u.checkout(),c.notify({type:"positive",message:t("checkoutSuccess")}),_.push("/order-history")}catch(n){((e=n.response)==null?void 0:e.status)===401?(c.notify({type:"negative",color:"accent",message:t("unauthorized")}),_.push("/user")):c.notify({type:"negative",color:"accent",message:n.message||t("checkoutError")})}},L=async()=>{try{const e=await c.dialog({title:t("confirmation"),message:t("proceedCheckout"),ok:{label:t("yes"),color:"primary",outline:!1},cancel:{label:t("no"),color:"primary",outline:!0},persistent:!0});e.onOk(async()=>{if(!c.cookies.get("token")){c.notify({type:"negative",color:"accent",message:t("notLoggedIn")}),_.push({path:"/user",query:{from:"/cart"}});return}await S()}),e.onCancel(()=>{}),e.onDismiss(()=>{console.log("Dialog dismissed.")})}catch(e){console.error("Dialog error:",e),c.notify({type:"negative",color:"accent",message:"An error occurred while opening the confirmation dialog."})}};return(e,n)=>(a(),i(A,{class:"q-pa-md"},{default:o(()=>[m("h5",G,r(e.$t("shopping-cart")),1),m("div",K,r(e.$t("here-is-the-product-you-order")),1),y(d).length?(a(),i(j,{key:0,bordered:"",separator:"",class:"rounded-borders"},{default:o(()=>[(a(!0),f(q,null,Q(y(d),(l,b)=>(a(),i(x,{key:b,class:"q-py-md"},{default:o(()=>[s(C,{avatar:""},{default:o(()=>[l.photoUrl?(a(),i($,{key:0,src:l.photoUrl,style:{width:"100px",height:"100px"},ratio:1,class:"rounded-borders"},null,8,["src"])):(a(),i($,{key:1,src:E}))]),_:2},1024),s(C,null,{default:o(()=>[s(k,{class:"item-name"},{default:o(()=>[g(r(l.name),1)]),_:2},1024),s(k,{caption:""},{default:o(()=>[g(r(e.$t("priceDetails",{label:e.$t("unitPrice"),price:l.price.toFixed(2)})),1)]),_:2},1024),(a(!0),f(q,null,Q(l.selectedOptions,p=>(a(),i(k,{key:p.category,caption:""},{default:o(()=>[g(r(p.category)+": "+r(p.option)+" (+$"+r(p.additionalPrice.toFixed(2))+") ",1)]),_:2},1024))),128)),s(k,{caption:""},{default:o(()=>[g(r(e.$t("priceDetails",{label:e.$t("total"),price:l.totalPrice.toFixed(2)})),1)]),_:2},1024)]),_:2},1024),s(C,{side:""},{default:o(()=>[m("div",W,r(e.$t("quantity",{quantity:l.quantity})),1),s(z,{spread:""},{default:o(()=>[s(h,{flat:"",color:"secondary",icon:"remove",onClick:p=>F(b)},null,8,["onClick"]),s(h,{flat:"",color:"primary",icon:"add",onClick:p=>B(b)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(a(),f("div",X,r(e.$t("your-cart-is-empty-now")),1)),m("div",Y,[y(d).length?v("",!0):(a(),i(h,{key:0,color:"primary",label:y(t)("buy-now"),onClick:n[0]||(n[0]=l=>e.$router.push("/menu")),class:"cta-button"},null,8,["label"]))]),y(d).length?(a(),i(w,{key:2,class:"q-my-md"})):v("",!0),y(d).length?(a(),f("div",H,[s(h,{outline:"",class:"clear-cart",label:e.$t("clear-cart"),onClick:D},null,8,["label"]),s(h,{color:"primary",onClick:L,class:"cta-button"},{default:o(()=>[m("div",J,[m("div",Z,r(e.$t("checkout")),1),s(w,{vertical:"",inset:"",color:"white"}),m("div",ee,"$"+r(Math.ceil(I.value).toFixed(2)),1)])]),_:1})])):v("",!0)]),_:1}))}}),ce=R(te,[["__scopeId","data-v-c6877da0"]]);export{ce as default};
