import{Q as x}from"./QImg-B9CJ00EJ.js";import{Q as V,a as Y,b,c as _}from"./QList-BXB7ASh3.js";import{d as A,v as L,u as z,x as O,c as R,r as j,U as D,e,z as c,w as t,j as y,f as k,A as I,i as a,k as v,B as l,F as S,g as u,D as f,S as Q,V as B,W as C,p as G,l as M,_ as E}from"./index-DhLXV12e.js";import{Q as H}from"./QBtnGroup-B28EQl-3.js";import{Q as K}from"./QPage-DQ7UFi_V.js";const W=""+new URL("PepeBugFly-fXrYNeKG.png",import.meta.url).href,w=h=>(G("data-v-093c9b51"),h=h(),M(),h),X=w(()=>u("h5",{class:"page-title"},"ðŸ›’Shopping Cart ",-1)),J=w(()=>u("div",{style:{"font-size":"1rem","margin-bottom":"1rem","text-align":"center"}},"Here is the product you order. ðŸ³",-1)),Z={class:"normal-font q-mb-sm"},ee={key:1,class:"text-h6 q-pa-md text-center text-color text-color-primary"},te={class:"btn-container"},ae={key:3,class:"row justify-between items-center q-mt-md"},oe={class:"row no-wrap items-center"},re=w(()=>u("div",{class:"q-mr-sm text-base"},"Checkout",-1)),se={class:"q-ml-sm text-base"},ce=A({__name:"Cart",setup(h){const g=L(),n=z(),{cart:i}=O(n),F=R(()=>n.cartTotal),q=j(!1),p=D(),N=r=>{const s=i.value[r];n.updateCartItemQuantity(r,s.quantity+1)},$=r=>{const s=i.value[r];s.quantity>1?n.updateCartItemQuantity(r,s.quantity-1):n.removeFromCart(r)},P=()=>{p.dialog({title:"Confirm",message:"Are you sure you want to clear your cart?",ok:{label:"Yes",color:"primary"},cancel:{label:"No",color:"primary",outline:!0},persistent:!0}).onOk(()=>{n.clearCart(),p.notify({color:"secondary",message:"Cart cleared successfully!"})}).onCancel(()=>{})},U=async()=>{q.value=!0;try{await n.checkout(),g.push("/order-history")}catch{p.notify({color:"accent",message:"Failed to place order. Please try again."})}finally{q.value=!1}},T=async()=>{(await p.dialog({title:"Confirmation",message:"Are you sure you want to proceed with checkout?",ok:{label:"Yes",color:"primary",outline:!1},cancel:{label:"No",color:"primary",outline:!0},persistent:!0})).onOk(async()=>{var o;if(!p.cookies.get("token")){C.create({type:"negative",color:"accent",message:"You are not logged in yet. Please login first."}),g.push({path:"/user",query:{from:"/cart"}});return}try{await U(),C.create({type:"positive",message:"Checkout successful!"}),g.push("/order-history")}catch(d){((o=d.response)==null?void 0:o.status)===401?(C.create({color:"accent",type:"negative",message:"Unauthorized. Please log in again."}),g.push("/user")):C.create({color:"accent",type:"negative",message:d.message||"An error occurred during checkout."})}})};return(r,s)=>(e(),c(K,{class:"q-pa-md"},{default:t(()=>[X,J,y(i).length?(e(),c(V,{key:0,bordered:"",separator:"",class:"rounded-borders"},{default:t(()=>[(e(!0),k(S,null,I(y(i),(o,d)=>(e(),c(Y,{key:d,class:"q-py-md"},{default:t(()=>[a(b,{avatar:""},{default:t(()=>[o.photoUrl?(e(),c(x,{key:0,src:o.photoUrl,style:{width:"100px",height:"100px"},ratio:1,class:"rounded-borders"},null,8,["src"])):(e(),c(x,{key:1,src:W}))]),_:2},1024),a(b,null,{default:t(()=>[a(_,{class:"item-name"},{default:t(()=>[v(l(o.name),1)]),_:2},1024),a(_,{caption:""},{default:t(()=>[v(" Unit: $"+l(o.price.toFixed(2)),1)]),_:2},1024),(e(!0),k(S,null,I(o.selectedOptions,m=>(e(),c(_,{key:m.category,caption:""},{default:t(()=>[v(l(m.category)+": "+l(m.option)+" (+$"+l(m.additionalPrice.toFixed(2))+") ",1)]),_:2},1024))),128)),a(_,{caption:""},{default:t(()=>[v(" Total: $"+l(o.totalPrice.toFixed(2)),1)]),_:2},1024)]),_:2},1024),a(b,{side:""},{default:t(()=>[u("div",Z," Quantity: "+l(o.quantity),1),a(H,{spread:""},{default:t(()=>[a(f,{flat:"",color:"secondary",icon:"remove",onClick:m=>$(d)},null,8,["onClick"]),a(f,{flat:"",color:"primary",icon:"add",onClick:m=>N(d)},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})):(e(),k("div",ee," Your cart is empty now. ")),u("div",te,[y(i).length?Q("",!0):(e(),c(f,{key:0,color:"primary",label:"Buy Now ðŸ¤©",onClick:s[0]||(s[0]=o=>r.$router.push("/menu")),class:"cta-button"}))]),y(i).length?(e(),c(B,{key:2,class:"q-my-md"})):Q("",!0),y(i).length?(e(),k("div",ae,[a(f,{outline:"",class:"clear-cart",label:"Clear Cart",onClick:P}),a(f,{color:"primary",onClick:T,class:"cta-button"},{default:t(()=>[u("div",oe,[re,a(B,{vertical:"",inset:"",color:"white"}),u("div",se,"$"+l(Math.ceil(F.value).toFixed(2)),1)])]),_:1})])):Q("",!0)]),_:1}))}}),me=E(ce,[["__scopeId","data-v-093c9b51"]]);export{me as default};
