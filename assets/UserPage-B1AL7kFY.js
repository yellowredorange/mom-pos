import{ab as K,r as $,ac as X,d as R,V as B,b as Z,c as Q,f as k,j as A,w as u,l as a,i as e,t as s,C as _,ad as E,D as U,ae as D,E as S,af as Y,ag as V,_ as z,R as x,y as ee,ah as te,U as oe,ai as se,o as le,e as T,k as L,S as M,aj as P,m as w,ak as N}from"./index-CSkwx-TP.js";import{Q as ae}from"./QPage-u_qMsG84.js";import{d as j,l as O}from"./MomPosMainPageDark-BsLCBqY-.js";const re=K("user",()=>{const C=$(null);return{user:C,fetchUserInfo:async c=>{try{const i=await X(c);C.value=i}catch(i){console.error("Error fetching user info:",i)}},logout:()=>{C.value=null}}}),ne={class:"text-h6 text-center"},ie={class:"flex-center"},ue=["src"],de=R({__name:"RegisterComponent",setup(C){const{t}=B(),r=$(""),c=$(""),i=$(""),h=Z(),b=Q(()=>h.isDarkMode?j:O),m=async()=>{const v=(()=>{let l="";return(r.value.length<6||r.value.length>20)&&(l+=`${t("accountLengthError")} `),/^[a-zA-Z0-9._]+$/.test(r.value)||(l+=`${t("accountSpecialCharError")} `),/[_\.]{2,}/.test(r.value)&&(l+=`${t("accountConsecutiveError")} `),(!/^[a-zA-Z0-9]/.test(r.value)||!/[a-zA-Z0-9]$/.test(r.value))&&(l+=`${t("accountStartEndError")} `),/\b(admin|root)\b/.test(r.value)&&(l+=`${t("accountReservedWordError")} `),(c.value.length<8||c.value.length>20)&&(l+=`${t("passwordLengthError")} `),(!/[a-zA-Z]/.test(c.value)||!/\d/.test(c.value))&&(l+=`${t("passwordComplexityError")} `),l})();if(v){V.create({type:"negative",message:v.trim()});return}try{await Y({account:r.value,password:c.value,name:i.value}),V.create({type:"positive",message:t("registerSuccess")}),setTimeout(()=>{window.location.reload()},2e3)}catch(l){V.create({type:"negative",message:l.message||t("registerFailed")})}};return(p,v)=>(k(),A(S,{class:"rounded-borders"},{default:u(()=>[a(_,null,{default:u(()=>[e("div",ne,s(p.$t("register")),1)]),_:1}),a(_,null,{default:u(()=>[e("div",ie,[e("img",{src:b.value,"spinner-color":"white",class:"login-image"},null,8,ue)]),a(E,{modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=l=>i.value=l),label:p.$t("userName"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=l=>r.value=l),label:p.$t("account"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:c.value,"onUpdate:modelValue":v[2]||(v[2]=l=>c.value=l),label:p.$t("password"),type:"password",outlined:"",dense:""},null,8,["modelValue","label"])]),_:1}),a(D,{align:"center",class:"card-margin"},{default:u(()=>[a(U,{label:p.$t("register"),color:"primary",onClick:m,disable:!r.value||!c.value||!i.value},null,8,["label","disable"]),a(U,{label:p.$t("backToLogin"),color:"secondary",onClick:v[3]||(v[3]=l=>p.$emit("open-login"))},null,8,["label"])]),_:1})]),_:1}))}}),ce=z(de,[["__scopeId","data-v-9bcbe530"]]),me={class:"text-h6 text-center"},ve={class:"flex-center"},ge=["src"],pe={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},fe=R({__name:"LoginComponent",setup(C){const t=$(""),r=$(""),c=x(),i=ee(),h=typeof c.query.from=="string"?c.query.from:"/",b=Z(),{t:m}=B(),p=async()=>{const f=(()=>{let d="";return(t.value.length<6||t.value.length>20)&&(d+=`${m("accountLengthError")} `),/^[a-zA-Z0-9._]+$/.test(t.value)||(d+=`${m("accountSpecialCharError")} `),/[_\.]{2,}/.test(t.value)&&(d+=`${m("accountConsecutiveError")} `),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(d+=`${m("accountStartEndError")} `),/\b(admin|root)\b/.test(t.value)&&(d+=`${m("accountReservedWordError")} `),(r.value.length<8||r.value.length>20)&&(d+=`${m("passwordLengthError")} `),(!/[a-zA-Z]/.test(r.value)||!/\d/.test(r.value))&&(d+=`${m("passwordComplexityError")} `),d})();if(f){V.create({type:"negative",message:f.trim()});return}try{await te({account:t.value,password:r.value}),V.create({type:"positive",message:m("loginSuccess")}),i.push(h),setTimeout(()=>{window.location.reload()},0)}catch(d){let I=d.message||m("loginFailed");d.message=="loginTooMany"&&(I=m("loginTooMany")),V.create({type:"negative",message:I})}},v=Q(()=>b.isDarkMode?j:O);return(l,f)=>(k(),A(S,{class:"rounded-borders"},{default:u(()=>[a(_,null,{default:u(()=>[e("div",me,s(l.$t("welcome")),1)]),_:1}),a(_,null,{default:u(()=>[e("div",ve,[e("img",{src:v.value,"spinner-color":"white",class:"login-image"},null,8,ge)]),e("div",pe,[e("div",null,s(l.$t("noAccount")),1),e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:f[0]||(f[0]=d=>l.$emit("open-register"))},s(l.$t("clickForRegister")),1)]),a(E,{modelValue:t.value,"onUpdate:modelValue":f[1]||(f[1]=d=>t.value=d),label:l.$t("account"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=d=>r.value=d),label:l.$t("password"),type:"password",outlined:"",dense:""},null,8,["modelValue","label"])]),_:1}),a(D,{align:"center"},{default:u(()=>[a(U,{label:l.$t("login"),color:"primary",disable:!t.value||!r.value,onClick:p,class:"login-button"},null,8,["label","disable"])]),_:1})]),_:1}))}}),$e=z(fe,[["__scopeId","data-v-514591ea"]]),he={class:"user-page-container"},we={class:"q-ml-md"},ye={class:"text-h6",style:{"font-weight":"700"}},be={class:"text-h6",style:{"font-weight":"700"}},_e={class:"text-h6",style:{"font-weight":"700"}},Ce={class:"qa-container beautiful-shadow"},Ve={class:"text-h6 flex flex-center qa-title"},ke={class:"qa-list"},Ae={class:"qa-item"},Ee={class:"q-text"},Se={class:"a-text"},Ie={class:"qa-item"},Pe={class:"q-text"},Ue={class:"a-text"},qe={class:"qa-item"},Le={class:"q-text"},Re={class:"a-text"},Be={href:"mailto:yellowredorange1999@gmail.com?subject=About%20Project%20MomPos",class:"clickable-link"},Qe=R({__name:"UserPage",setup(C){const{t}=B(),r=oe(),c=re(),i=$(!1),h=$(!1),b=$(!1),m=$(!1),p=$(null),v=()=>{h.value=!1,i.value=!0},l=()=>{i.value=!1,h.value=!0},f=()=>{i.value=!1},d=()=>{h.value=!1},I=()=>{r.dialog({title:t("confirmLogout"),message:t("confirmLogoutMessage"),ok:{label:t("logout"),color:"primary"},cancel:{label:t("cancel"),color:"primary",outline:!0},persistent:!0}).onOk(()=>{c.logout(),y.logout(),q=!1,N.push("/"),r.notify({color:"secondary",message:t("logoutSuccess")})}).onCancel(()=>{r.notify({color:"primary",message:t("logoutCanceled")})})},F=()=>{i.value=!0};let q=!1;const y=se(),W=Q(()=>{var n;const o=(n=y.permission)==null?void 0:n.toLowerCase();return t(o?`permissions.${o}`:"notLoggedIn")}),G=()=>{y.setPermission("admin"),N.push("/menu-editor")};return le(async()=>{var o;if(!y.permission||!y.userId){i.value=!0;return}if(!q)try{await c.fetchUserInfo(parseInt(y.userId)),q=!0}catch(n){((o=n.response)==null?void 0:o.status)===401?i.value=!0:console.error("Unexpected error:",n)}}),(o,n)=>{const H=T("user-profile-component"),J=T("user-history-order-component");return k(),A(ae,{class:"q-pa-md flex flex-center"},{default:u(()=>[e("div",he,[a(S,{class:"user-profile-bar"},{default:u(()=>[a(_,{class:"row items-center"},{default:u(()=>{var g;return[a(U,{flat:"",round:"",onClick:n[0]||(n[0]=()=>{}),icon:"fas fa-user"}),e("div",we,[e("div",ye,s(((g=L(c).user)==null?void 0:g.userName)||o.$t("guest")),1),e("div",null,s(W.value),1)])]}),_:1})]),_:1}),L(y).permission?(k(),A(S,{key:0,class:"logout-bar",onClick:I},{default:u(()=>[a(_,{class:"logout-text"},{default:u(()=>[e("div",be,s(o.$t("logout")),1)]),_:1})]),_:1})):M("",!0),L(y).permission?M("",!0):(k(),A(S,{key:1,class:"logout-bar",onClick:F},{default:u(()=>[a(_,{class:"logout-text"},{default:u(()=>[e("div",_e,s(o.$t("login")),1)]),_:1})]),_:1})),a(P,{modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=g=>i.value=g)},{default:u(()=>[a($e,{onOpenRegister:l,onClose:f})]),_:1},8,["modelValue"]),a(P,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=g=>h.value=g)},{default:u(()=>[a(ce,{onOpenLogin:v,onClose:d})]),_:1},8,["modelValue"]),a(P,{modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=g=>b.value=g)},{default:u(()=>[a(H,{onClose:n[3]||(n[3]=g=>b.value=!1)})]),_:1},8,["modelValue"]),a(P,{modelValue:m.value,"onUpdate:modelValue":n[6]||(n[6]=g=>m.value=g)},{default:u(()=>[a(J,{order:p.value,onClose:n[5]||(n[5]=g=>m.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",Ce,[e("div",Ve,s(o.$t("qaTitle")),1),e("div",ke,[e("div",Ae,[e("div",Ee,[e("strong",null,s(o.$t("question"))+":",1),w(" "+s(o.$t("passwordRevealQuestion")),1)]),e("div",Se,[e("strong",null,s(o.$t("answer"))+":",1),w(" "+s(o.$t("passwordRevealAnswerPart1"))+" "+s(o.$t("passwordRevealAnswerPart2")),1)])]),e("div",Ie,[e("div",Pe,[e("strong",null,s(o.$t("question"))+":",1),w(" "+s(o.$t("shopperQuestion")),1)]),e("div",Ue,[e("strong",null,s(o.$t("answer"))+":",1),w(" "+s(o.$t("shopperAnswerPart1"))+" ",1),e("span",{class:"clickable-text",onClick:G},s(o.$t("shopperAnswerPart3")),1),w(" "+s(o.$t("shopperAnswerPart4")),1)])]),e("div",qe,[e("div",Le,[e("strong",null,s(o.$t("question"))+":",1),w(" "+s(o.$t("selfBuildQuestion")),1)]),e("div",Re,[e("strong",null,s(o.$t("answer"))+":",1),w(" "+s(o.$t("selfBuildAnswerPart1"))+" ",1),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:n[7]||(n[7]=g=>o.$router.push("/project-details"))},s(o.$t("selfBuildAnswerPart3")),1),w(" "+s(o.$t("selfBuildAnswerPart4"))+" "+s(o.$t("selfBuildAnswerPart5"))+" ",1),e("a",Be,s(o.$t("selfBuildAnswerPart7")),1),w(" "+s(o.$t("selfBuildAnswerPart8",{email:"yellowredorange1999@gmail.com"})),1)])])])])]),_:1})}}}),Ne=z(Qe,[["__scopeId","data-v-7a865786"]]);export{Ne as default};
