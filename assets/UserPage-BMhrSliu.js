import{a8 as X,r as v,a9 as ee,d as S,a as D,c as Z,i as k,y as V,w as r,f as s,G as _,e,aa as x,B as $,ab as B,E as C,ac as te,V as w,p as L,k as P,_ as Q,ad as oe,S as se,o as ae,g as q,D as N,A as I,R as z,ae as A,j as p}from"./index-C5q-uV_y.js";import{Q as le}from"./QPage-Bw-uGZRa.js";import{d as j,l as T}from"./MomPosMainPageDark-BsLCBqY-.js";const ne=X("user",()=>{const i=v(null);return{user:i,fetchUserInfo:async u=>{try{const m=await ee(u);i.value=m}catch(m){console.error("Error fetching user info:",m)}},logout:()=>{i.value=null}}}),re=i=>(L("data-v-4777f04c"),i=i(),P(),i),ie=re(()=>e("div",{class:"text-h6 text-center"},"Register",-1)),ue={class:"flex-center"},ce=["src"],de=S({__name:"RegisterComponent",setup(i){const t=v(""),a=v(""),u=v(""),m=D(),h=Z(()=>m.isDarkMode?j:T),f=async()=>{const o=(()=>{let n="";return(t.value.length<6||t.value.length>20)&&(n+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(n+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(n+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(n+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(n+='Account must not include reserved words like "admin" or "root". '),(a.value.length<8||a.value.length>20)&&(n+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(a.value)||!/\d/.test(a.value))&&(n+="Password must include both letters and numbers. "),n})();if(o){w.create({type:"negative",message:o.trim()});return}try{await te({account:t.value,password:a.value,name:u.value}),w.create({type:"positive",message:"Registration successful! Please login now"}),setTimeout(()=>{window.location.reload()},2e3)}catch(n){w.create({type:"negative",message:n.message||"Registration failed. Please try again."})}};return(c,o)=>(k(),V(C,{class:"rounded-borders"},{default:r(()=>[s(_,null,{default:r(()=>[ie]),_:1}),s(_,null,{default:r(()=>[e("div",ue,[e("img",{src:h.value,"spinner-color":"white",class:"login-image"},null,8,ce)]),s(x,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=n=>u.value=n),label:"User Name",outlined:"",dense:""},null,8,["modelValue"]),s(x,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=n=>t.value=n),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),s(x,{modelValue:a.value,"onUpdate:modelValue":o[2]||(o[2]=n=>a.value=n),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),s(B,{align:"center",class:"card-margin"},{default:r(()=>[s($,{label:"Register",color:"primary",onClick:f,disable:!t.value||!a.value||!u.value},null,8,["disable"]),s($,{label:"Back to Login",color:"secondary",onClick:o[3]||(o[3]=n=>c.$emit("open-login"))})]),_:1})]),_:1}))}}),me=Q(de,[["__scopeId","data-v-4777f04c"]]),E=i=>(L("data-v-1f7302fd"),i=i(),P(),i),ve=E(()=>e("div",{class:"text-h6 text-center"},"Welcome!",-1)),pe={class:"flex-center"},fe=["src"],ge={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},he=E(()=>e("div",null,"Do not have account?",-1)),_e=S({__name:"LoginComponent",setup(i){const t=v(""),a=v(""),u=D(),m=async()=>{const c=(()=>{let o="";return(t.value.length<6||t.value.length>20)&&(o+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(o+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(o+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(o+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(o+='Account must not include reserved words like "admin" or "root". '),(a.value.length<8||a.value.length>20)&&(o+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(a.value)||!/\d/.test(a.value))&&(o+="Password must include both letters and numbers. "),o})();if(c){w.create({type:"negative",message:c.trim()});return}try{await oe({account:t.value,password:a.value}),w.create({type:"positive",message:"Login successful!"})}catch(o){w.create({type:"negative",message:o.message||"Login failed. Please try again."})}},h=Z(()=>u.isDarkMode?j:T);return(f,c)=>(k(),V(C,{class:"rounded-borders"},{default:r(()=>[s(_,null,{default:r(()=>[ve]),_:1}),s(_,null,{default:r(()=>[e("div",pe,[e("img",{src:h.value,"spinner-color":"white",class:"login-image"},null,8,fe)]),e("div",ge,[he,e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:c[0]||(c[0]=o=>f.$emit("open-register"))}," Click For Register! ")]),s(x,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=o=>t.value=o),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),s(x,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=o=>a.value=o),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),s(B,{align:"center"},{default:r(()=>[s($,{label:"Login",color:"primary",disable:!t.value||!a.value,onClick:m,class:"login-button"},null,8,["disable"])]),_:1})]),_:1}))}}),we=Q(_e,[["__scopeId","data-v-1f7302fd"]]),g=i=>(L("data-v-061ddcec"),i=i(),P(),i),be={class:"user-page-container"},ye={class:"q-ml-md"},ke={class:"text-h6",style:{"font-weight":"700"}},Ve=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Logout",-1)),xe=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Login",-1)),Ce={class:"qa-container beautiful-shadow"},Ie=g(()=>e("div",{class:"text-h6 flex flex-center qa-title"},"Q & A",-1)),Ae={class:"qa-list"},$e=g(()=>e("div",{class:"qa-item"},[e("div",{class:"q-text"},[e("strong",null,"Q:"),p(" Will you reveal my password? ")]),e("div",{class:"a-text"},[e("strong",null,"A:"),p(" No. I use PasswordHasher in .NET Core, so your password is securely hashed and never actually stored in the database. Don't worry. You can also just use a fake password to register. ")])],-1)),Ue={class:"qa-item"},Se=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),p(" Did you build this on your own? ")],-1)),Le={class:"a-text"},Pe=g(()=>e("strong",null,"A:",-1)),Qe=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),p(" Can I become a shopper to build my own menu? ")],-1)),Re=g(()=>e("strong",null,"A:",-1)),qe=S({__name:"UserPage",setup(i){const t=se(),a=ne(),u=v(!1),m=v(!1),h=v(!1),f=v(!1),c=v(null),o=()=>{m.value=!1,u.value=!0},n=()=>{u.value=!1,m.value=!0},O=()=>{u.value=!1},Y=()=>{m.value=!1},M=()=>{confirm("Are you sure you want to logout?")&&(a.logout(),t.cookies.remove("token"),t.cookies.remove("permission"),t.cookies.remove("userId"),U=!1,window.location.href="/user")},F=()=>{u.value=!0};let U=!1;const G=t.cookies.get("token"),R=t.cookies.get("userId"),b=t.cookies.get("permission"),W=b==null?void 0:b.toUpperCase(),H=()=>{t.cookies.remove("permission"),t.cookies.set("permission","admin",{path:"/",expires:1}),window.location.href=`${window.location.origin}/#/menu-editor`,setTimeout(()=>{window.location.reload()},2e3)};return ae(async()=>{var y;if(console.log("yooo"),!G||!R){u.value=!0;return}if(!U)try{await a.fetchUserInfo(parseInt(R)),U=!0}catch(l){((y=l.response)==null?void 0:y.status)===401?u.value=!0:console.error("Unexpected error:",l)}}),(y,l)=>{const J=q("user-profile-component"),K=q("user-history-order-component");return k(),V(le,{class:"q-pa-md flex flex-center"},{default:r(()=>[e("div",be,[s(C,{class:"user-profile-bar"},{default:r(()=>[s(_,{class:"row items-center"},{default:r(()=>{var d;return[s($,{flat:"",round:"",onClick:l[0]||(l[0]=()=>{}),icon:"fas fa-user"}),e("div",ye,[e("div",ke,N(((d=I(a).user)==null?void 0:d.userName)||"Guest"),1),e("div",null,N(I(W)||"Not logged in"),1)])]}),_:1})]),_:1}),I(b)?(k(),V(C,{key:0,class:"logout-bar",onClick:M},{default:r(()=>[s(_,{class:"logout-text"},{default:r(()=>[Ve]),_:1})]),_:1})):z("",!0),I(b)?z("",!0):(k(),V(C,{key:1,class:"logout-bar",onClick:F},{default:r(()=>[s(_,{class:"logout-text"},{default:r(()=>[xe]),_:1})]),_:1})),s(A,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=d=>u.value=d)},{default:r(()=>[s(we,{onOpenRegister:n,onClose:O})]),_:1},8,["modelValue"]),s(A,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=d=>m.value=d)},{default:r(()=>[s(me,{onOpenLogin:o,onClose:Y})]),_:1},8,["modelValue"]),s(A,{modelValue:h.value,"onUpdate:modelValue":l[4]||(l[4]=d=>h.value=d)},{default:r(()=>[s(J,{onClose:l[3]||(l[3]=d=>h.value=!1)})]),_:1},8,["modelValue"]),s(A,{modelValue:f.value,"onUpdate:modelValue":l[6]||(l[6]=d=>f.value=d)},{default:r(()=>[s(K,{order:c.value,onClose:l[5]||(l[5]=d=>f.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",Ce,[Ie,e("div",Ae,[$e,e("div",Ue,[Se,e("div",Le,[Pe,p(" Yes, I built both the frontend and backend by myself. Click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:l[7]||(l[7]=d=>y.$router.push("/project-details"))},"here"),p(" to see the details of how I built this. I initially thought it would be a simple website, but it became much more complicated and cost me a lot of time. ðŸ«  If you'd like to give me some advice, just click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:l[8]||(l[8]=d=>y.$router.push("/feedback"))},"here"),p(". Thank you! ")])]),e("div",{class:"qa-item"},[Qe,e("div",{class:"a-text"},[Re,p(" Yes, but not yet. It's still in the beta phase. You can click "),e("span",{class:"clickable-text",onClick:H},"here"),p(" to explore the menu editor, but you can't save changes to the backend yet. ")])])])])]),_:1})}}}),Ze=Q(qe,[["__scopeId","data-v-061ddcec"]]);export{Ze as default};
