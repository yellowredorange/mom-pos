import{a9 as K,r as $,aa as X,d as P,V as R,b as D,c as B,f as k,j as A,w as i,l as a,i as e,t as o,C as _,ab as E,D as U,ac as T,E as S,ad as Y,ae as V,_ as Q,R as x,y as ee,af as te,U as se,ag as oe,o as le,e as z,k as L,S as N,ah as I,m as w,ai as Z}from"./index-Cxya-pB3.js";import{Q as ae}from"./QPage-DQWCz8DX.js";import{d as O,l as j}from"./MomPosMainPageDark-BsLCBqY-.js";const re=K("user",()=>{const C=$(null);return{user:C,fetchUserInfo:async d=>{try{const u=await X(d);C.value=u}catch(u){console.error("Error fetching user info:",u)}},logout:()=>{C.value=null}}}),ne={class:"text-h6 text-center"},ue={class:"flex-center"},ie=["src"],de=P({__name:"RegisterComponent",setup(C){const{t:s}=R(),r=$(""),d=$(""),u=$(""),h=D(),y=B(()=>h.isDarkMode?O:j),v=async()=>{const p=(()=>{let l="";return(r.value.length<6||r.value.length>20)&&(l+=`${s("accountLengthError")} `),/^[a-zA-Z0-9._]+$/.test(r.value)||(l+=`${s("accountSpecialCharError")} `),/[_\.]{2,}/.test(r.value)&&(l+=`${s("accountConsecutiveError")} `),(!/^[a-zA-Z0-9]/.test(r.value)||!/[a-zA-Z0-9]$/.test(r.value))&&(l+=`${s("accountStartEndError")} `),/\b(admin|root)\b/.test(r.value)&&(l+=`${s("accountReservedWordError")} `),(d.value.length<8||d.value.length>20)&&(l+=`${s("passwordLengthError")} `),(!/[a-zA-Z]/.test(d.value)||!/\d/.test(d.value))&&(l+=`${s("passwordComplexityError")} `),l})();if(p){V.create({type:"negative",message:p.trim()});return}try{await Y({account:r.value,password:d.value,name:u.value}),V.create({type:"positive",message:s("registerSuccess")}),setTimeout(()=>{window.location.reload()},2e3)}catch(l){V.create({type:"negative",message:l.message||s("registerFailed")})}};return(f,p)=>(k(),A(S,{class:"rounded-borders"},{default:i(()=>[a(_,null,{default:i(()=>[e("div",ne,o(f.$t("register")),1)]),_:1}),a(_,null,{default:i(()=>[e("div",ue,[e("img",{src:y.value,"spinner-color":"white",class:"login-image"},null,8,ie)]),a(E,{modelValue:u.value,"onUpdate:modelValue":p[0]||(p[0]=l=>u.value=l),label:f.$t("userName"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:r.value,"onUpdate:modelValue":p[1]||(p[1]=l=>r.value=l),label:f.$t("account"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:d.value,"onUpdate:modelValue":p[2]||(p[2]=l=>d.value=l),label:f.$t("password"),type:"password",outlined:"",dense:""},null,8,["modelValue","label"])]),_:1}),a(T,{align:"center",class:"card-margin"},{default:i(()=>[a(U,{label:f.$t("register"),color:"primary",onClick:v,disable:!r.value||!d.value||!u.value},null,8,["label","disable"]),a(U,{label:f.$t("backToLogin"),color:"secondary",onClick:p[3]||(p[3]=l=>f.$emit("open-login"))},null,8,["label"])]),_:1})]),_:1}))}}),ce=Q(de,[["__scopeId","data-v-9bcbe530"]]),ve={class:"text-h6 text-center"},pe={class:"flex-center"},me=["src"],fe={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},ge=P({__name:"LoginComponent",setup(C){const s=$(""),r=$(""),d=x(),u=ee(),h=typeof d.query.from=="string"?d.query.from:"/",y=D(),{t:v}=R(),f=async()=>{const g=(()=>{let c="";return(s.value.length<6||s.value.length>20)&&(c+=`${v("accountLengthError")} `),/^[a-zA-Z0-9._]+$/.test(s.value)||(c+=`${v("accountSpecialCharError")} `),/[_\.]{2,}/.test(s.value)&&(c+=`${v("accountConsecutiveError")} `),(!/^[a-zA-Z0-9]/.test(s.value)||!/[a-zA-Z0-9]$/.test(s.value))&&(c+=`${v("accountStartEndError")} `),/\b(admin|root)\b/.test(s.value)&&(c+=`${v("accountReservedWordError")} `),(r.value.length<8||r.value.length>20)&&(c+=`${v("passwordLengthError")} `),(!/[a-zA-Z]/.test(r.value)||!/\d/.test(r.value))&&(c+=`${v("passwordComplexityError")} `),c})();if(g){V.create({type:"negative",message:g.trim()});return}try{await te({account:s.value,password:r.value}),V.create({type:"positive",message:v("loginSuccess")}),u.push(h),setTimeout(()=>{window.location.reload()},0)}catch(c){V.create({type:"negative",message:c.message||v("loginFailed")})}},p=B(()=>y.isDarkMode?O:j);return(l,g)=>(k(),A(S,{class:"rounded-borders"},{default:i(()=>[a(_,null,{default:i(()=>[e("div",ve,o(l.$t("welcome")),1)]),_:1}),a(_,null,{default:i(()=>[e("div",pe,[e("img",{src:p.value,"spinner-color":"white",class:"login-image"},null,8,me)]),e("div",fe,[e("div",null,o(l.$t("noAccount")),1),e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:g[0]||(g[0]=c=>l.$emit("open-register"))},o(l.$t("clickForRegister")),1)]),a(E,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=c=>s.value=c),label:l.$t("account"),outlined:"",dense:""},null,8,["modelValue","label"]),a(E,{modelValue:r.value,"onUpdate:modelValue":g[2]||(g[2]=c=>r.value=c),label:l.$t("password"),type:"password",outlined:"",dense:""},null,8,["modelValue","label"])]),_:1}),a(T,{align:"center"},{default:i(()=>[a(U,{label:l.$t("login"),color:"primary",disable:!s.value||!r.value,onClick:f,class:"login-button"},null,8,["label","disable"])]),_:1})]),_:1}))}}),$e=Q(ge,[["__scopeId","data-v-14304387"]]),he={class:"user-page-container"},we={class:"q-ml-md"},be={class:"text-h6",style:{"font-weight":"700"}},ye={class:"text-h6",style:{"font-weight":"700"}},_e={class:"text-h6",style:{"font-weight":"700"}},Ce={class:"qa-container beautiful-shadow"},Ve={class:"text-h6 flex flex-center qa-title"},ke={class:"qa-list"},Ae={class:"qa-item"},Ee={class:"q-text"},Se={class:"a-text"},Ie={class:"qa-item"},Ue={class:"q-text"},qe={class:"a-text"},Le={class:"qa-item"},Pe={class:"q-text"},Re={class:"a-text"},Be=P({__name:"UserPage",setup(C){const{t:s}=R(),r=se(),d=re(),u=$(!1),h=$(!1),y=$(!1),v=$(!1),f=$(null),p=()=>{h.value=!1,u.value=!0},l=()=>{u.value=!1,h.value=!0},g=()=>{u.value=!1},c=()=>{h.value=!1},F=()=>{r.dialog({title:s("confirmLogout"),message:s("confirmLogoutMessage"),ok:{label:s("logout"),color:"primary"},cancel:{label:s("cancel"),color:"primary",outline:!0},persistent:!0}).onOk(()=>{d.logout(),b.logout(),q=!1,Z.push("/"),r.notify({color:"secondary",message:s("logoutSuccess")})}).onCancel(()=>{r.notify({color:"primary",message:s("logoutCanceled")})})},M=()=>{u.value=!0};let q=!1;const b=oe(),W=B(()=>{var n;const t=(n=b.permission)==null?void 0:n.toLowerCase();return s(t?`permissions.${t}`:"notLoggedIn")}),G=()=>{b.setPermission("admin"),Z.push("/menu-editor")};return le(async()=>{var t;if(!b.permission||!b.userId){u.value=!0;return}if(!q)try{await d.fetchUserInfo(parseInt(b.userId)),q=!0}catch(n){((t=n.response)==null?void 0:t.status)===401?u.value=!0:console.error("Unexpected error:",n)}}),(t,n)=>{const H=z("user-profile-component"),J=z("user-history-order-component");return k(),A(ae,{class:"q-pa-md flex flex-center"},{default:i(()=>[e("div",he,[a(S,{class:"user-profile-bar"},{default:i(()=>[a(_,{class:"row items-center"},{default:i(()=>{var m;return[a(U,{flat:"",round:"",onClick:n[0]||(n[0]=()=>{}),icon:"fas fa-user"}),e("div",we,[e("div",be,o(((m=L(d).user)==null?void 0:m.userName)||t.$t("guest")),1),e("div",null,o(W.value),1)])]}),_:1})]),_:1}),L(b).permission?(k(),A(S,{key:0,class:"logout-bar",onClick:F},{default:i(()=>[a(_,{class:"logout-text"},{default:i(()=>[e("div",ye,o(t.$t("logout")),1)]),_:1})]),_:1})):N("",!0),L(b).permission?N("",!0):(k(),A(S,{key:1,class:"logout-bar",onClick:M},{default:i(()=>[a(_,{class:"logout-text"},{default:i(()=>[e("div",_e,o(t.$t("login")),1)]),_:1})]),_:1})),a(I,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=m=>u.value=m)},{default:i(()=>[a($e,{onOpenRegister:l,onClose:g})]),_:1},8,["modelValue"]),a(I,{modelValue:h.value,"onUpdate:modelValue":n[2]||(n[2]=m=>h.value=m)},{default:i(()=>[a(ce,{onOpenLogin:p,onClose:c})]),_:1},8,["modelValue"]),a(I,{modelValue:y.value,"onUpdate:modelValue":n[4]||(n[4]=m=>y.value=m)},{default:i(()=>[a(H,{onClose:n[3]||(n[3]=m=>y.value=!1)})]),_:1},8,["modelValue"]),a(I,{modelValue:v.value,"onUpdate:modelValue":n[6]||(n[6]=m=>v.value=m)},{default:i(()=>[a(J,{order:f.value,onClose:n[5]||(n[5]=m=>v.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",Ce,[e("div",Ve,o(t.$t("qaTitle")),1),e("div",ke,[e("div",Ae,[e("div",Ee,[e("strong",null,o(t.$t("question"))+":",1),w(" "+o(t.$t("passwordRevealQuestion")),1)]),e("div",Se,[e("strong",null,o(t.$t("answer"))+":",1),w(" "+o(t.$t("passwordRevealAnswerPart1"))+" "+o(t.$t("passwordRevealAnswerPart2")),1)])]),e("div",Ie,[e("div",Ue,[e("strong",null,o(t.$t("question"))+":",1),w(" "+o(t.$t("shopperQuestion")),1)]),e("div",qe,[e("strong",null,o(t.$t("answer"))+":",1),w(" "+o(t.$t("shopperAnswerPart1"))+" ",1),e("span",{class:"clickable-text",onClick:G},o(t.$t("shopperAnswerPart3")),1),w(" "+o(t.$t("shopperAnswerPart4")),1)])]),e("div",Le,[e("div",Pe,[e("strong",null,o(t.$t("question"))+":",1),w(" "+o(t.$t("selfBuildQuestion")),1)]),e("div",Re,[e("strong",null,o(t.$t("answer"))+":",1),w(" "+o(t.$t("selfBuildAnswerPart1"))+" ",1),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:n[7]||(n[7]=m=>t.$router.push("/project-details"))},o(t.$t("selfBuildAnswerPart3")),1),w(" "+o(t.$t("selfBuildAnswerPart4"))+" "+o(t.$t("selfBuildAnswerPart5"))+" ",1),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:n[8]||(n[8]=m=>t.$router.push("/feedback"))},o(t.$t("selfBuildAnswerPart7")),1),w(" "+o(t.$t("selfBuildAnswerPart8")),1)])])])])]),_:1})}}}),Ze=Q(Be,[["__scopeId","data-v-6cbfa2a7"]]);export{Ze as default};
