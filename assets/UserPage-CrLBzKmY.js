import{a8 as ee,r as p,a9 as te,d as P,a as j,c as E,i as V,y as x,w as n,f as o,G as b,e,aa as I,B as R,ab as O,E as A,ac as oe,V as k,p as q,k as Q,_ as N,P as se,t as ae,ad as le,S as ne,o as re,g as T,D as Z,A as $,R as B,ae as U,j as f}from"./index-CmO1ZBgq.js";import{Q as ie}from"./QPage-C3WPE4dE.js";import{d as Y,l as M}from"./MomPosMainPageDark-BsLCBqY-.js";const ue=ee("user",()=>{const r=p(null);return{user:r,fetchUserInfo:async i=>{try{const m=await te(i);r.value=m}catch(m){console.error("Error fetching user info:",m)}},logout:()=>{r.value=null}}}),ce=r=>(q("data-v-4777f04c"),r=r(),Q(),r),de=ce(()=>e("div",{class:"text-h6 text-center"},"Register",-1)),me={class:"flex-center"},ve=["src"],pe=P({__name:"RegisterComponent",setup(r){const t=p(""),a=p(""),i=p(""),m=j(),h=E(()=>m.isDarkMode?Y:M),_=async()=>{const c=(()=>{let l="";return(t.value.length<6||t.value.length>20)&&(l+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(l+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(l+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(l+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(l+='Account must not include reserved words like "admin" or "root". '),(a.value.length<8||a.value.length>20)&&(l+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(a.value)||!/\d/.test(a.value))&&(l+="Password must include both letters and numbers. "),l})();if(c){k.create({type:"negative",message:c.trim()});return}try{await oe({account:t.value,password:a.value,name:i.value}),k.create({type:"positive",message:"Registration successful! Please login now"}),setTimeout(()=>{window.location.reload()},2e3)}catch(l){k.create({type:"negative",message:l.message||"Registration failed. Please try again."})}};return(y,c)=>(V(),x(A,{class:"rounded-borders"},{default:n(()=>[o(b,null,{default:n(()=>[de]),_:1}),o(b,null,{default:n(()=>[e("div",me,[e("img",{src:h.value,"spinner-color":"white",class:"login-image"},null,8,ve)]),o(I,{modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=l=>i.value=l),label:"User Name",outlined:"",dense:""},null,8,["modelValue"]),o(I,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=l=>t.value=l),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),o(I,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=l=>a.value=l),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),o(O,{align:"center",class:"card-margin"},{default:n(()=>[o(R,{label:"Register",color:"primary",onClick:_,disable:!t.value||!a.value||!i.value},null,8,["disable"]),o(R,{label:"Back to Login",color:"secondary",onClick:c[3]||(c[3]=l=>y.$emit("open-login"))})]),_:1})]),_:1}))}}),fe=N(pe,[["__scopeId","data-v-4777f04c"]]),F=r=>(q("data-v-2fd64e32"),r=r(),Q(),r),ge=F(()=>e("div",{class:"text-h6 text-center"},"Welcome!",-1)),he={class:"flex-center"},_e=["src"],we={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},be=F(()=>e("div",null,"Do not have account?",-1)),ye=P({__name:"LoginComponent",setup(r){const t=p(""),a=p(""),i=se(),m=ae(),h=typeof i.query.from=="string"?i.query.from:"/",_=j(),y=async()=>{const v=(()=>{let u="";return(t.value.length<6||t.value.length>20)&&(u+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(u+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(u+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(u+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(u+='Account must not include reserved words like "admin" or "root". '),(a.value.length<8||a.value.length>20)&&(u+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(a.value)||!/\d/.test(a.value))&&(u+="Password must include both letters and numbers. "),u})();if(v){k.create({type:"negative",message:v.trim()});return}try{await le({account:t.value,password:a.value}),k.create({type:"positive",message:"Login successful!"}),m.push(h),setTimeout(()=>{window.location.reload()},0)}catch(u){k.create({type:"negative",message:u.message||"Login failed. Please try again."})}},c=E(()=>_.isDarkMode?Y:M);return(l,v)=>(V(),x(A,{class:"rounded-borders"},{default:n(()=>[o(b,null,{default:n(()=>[ge]),_:1}),o(b,null,{default:n(()=>[e("div",he,[e("img",{src:c.value,"spinner-color":"white",class:"login-image"},null,8,_e)]),e("div",we,[be,e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:v[0]||(v[0]=u=>l.$emit("open-register"))}," Click For Register! ")]),o(I,{modelValue:t.value,"onUpdate:modelValue":v[1]||(v[1]=u=>t.value=u),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),o(I,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=u=>a.value=u),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),o(O,{align:"center"},{default:n(()=>[o(R,{label:"Login",color:"primary",disable:!t.value||!a.value,onClick:y,class:"login-button"},null,8,["disable"])]),_:1})]),_:1}))}}),ke=N(ye,[["__scopeId","data-v-2fd64e32"]]),g=r=>(q("data-v-b58ef1f9"),r=r(),Q(),r),Ce={class:"user-page-container"},Ve={class:"q-ml-md"},xe={class:"text-h6",style:{"font-weight":"700"}},Ie=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Logout",-1)),Ae=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Login",-1)),$e={class:"qa-container beautiful-shadow"},Ue=g(()=>e("div",{class:"text-h6 flex flex-center qa-title"},"Q & A",-1)),Re={class:"qa-list"},Se=g(()=>e("div",{class:"qa-item"},[e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Will you reveal my password? ")]),e("div",{class:"a-text"},[e("strong",null,"A:"),f(" No. I use PasswordHasher in .NET Core, so your password is securely hashed and never actually stored in the database. Don't worry. You can also just use a fake password to register. ")])],-1)),Le={class:"qa-item"},Pe=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Did you build this on your own? ")],-1)),qe={class:"a-text"},Qe=g(()=>e("strong",null,"A:",-1)),Ne=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Can I become a shopper to build my own menu? ")],-1)),ze=g(()=>e("strong",null,"A:",-1)),De=P({__name:"UserPage",setup(r){const t=ne(),a=ue(),i=p(!1),m=p(!1),h=p(!1),_=p(!1),y=p(null),c=()=>{m.value=!1,i.value=!0},l=()=>{i.value=!1,m.value=!0},v=()=>{i.value=!1},u=()=>{m.value=!1},G=()=>{confirm("Are you sure you want to logout?")&&(a.logout(),t.cookies.remove("token"),t.cookies.remove("permission"),t.cookies.remove("userId"),S=!1,window.location.href="/user")},W=()=>{i.value=!0};let S=!1;function L(w){const s=document.cookie.match(new RegExp("(^|;\\s*)"+w+"=([^;]*)"));return s?decodeURIComponent(s[2]):null}const z=L("token"),D=L("userId"),C=L("permission"),H=C==null?void 0:C.toUpperCase();console.log(z);const J=()=>{t.cookies.remove("permission"),t.cookies.set("permission","admin",{path:"/",expires:1}),window.location.href=`${window.location.origin}/#/menu-editor`,setTimeout(()=>{window.location.reload()},2e3)};return re(async()=>{var w;if(console.log("yooo"),!z||!D){i.value=!0;return}if(!S)try{await a.fetchUserInfo(parseInt(D)),S=!0}catch(s){((w=s.response)==null?void 0:w.status)===401?i.value=!0:console.error("Unexpected error:",s)}}),(w,s)=>{const K=T("user-profile-component"),X=T("user-history-order-component");return V(),x(ie,{class:"q-pa-md flex flex-center"},{default:n(()=>[e("div",Ce,[o(A,{class:"user-profile-bar"},{default:n(()=>[o(b,{class:"row items-center"},{default:n(()=>{var d;return[o(R,{flat:"",round:"",onClick:s[0]||(s[0]=()=>{}),icon:"fas fa-user"}),e("div",Ve,[e("div",xe,Z(((d=$(a).user)==null?void 0:d.userName)||"Guest"),1),e("div",null,Z($(H)||"Not logged in"),1)])]}),_:1})]),_:1}),$(C)?(V(),x(A,{key:0,class:"logout-bar",onClick:G},{default:n(()=>[o(b,{class:"logout-text"},{default:n(()=>[Ie]),_:1})]),_:1})):B("",!0),$(C)?B("",!0):(V(),x(A,{key:1,class:"logout-bar",onClick:W},{default:n(()=>[o(b,{class:"logout-text"},{default:n(()=>[Ae]),_:1})]),_:1})),o(U,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=d=>i.value=d)},{default:n(()=>[o(ke,{onOpenRegister:l,onClose:v})]),_:1},8,["modelValue"]),o(U,{modelValue:m.value,"onUpdate:modelValue":s[2]||(s[2]=d=>m.value=d)},{default:n(()=>[o(fe,{onOpenLogin:c,onClose:u})]),_:1},8,["modelValue"]),o(U,{modelValue:h.value,"onUpdate:modelValue":s[4]||(s[4]=d=>h.value=d)},{default:n(()=>[o(K,{onClose:s[3]||(s[3]=d=>h.value=!1)})]),_:1},8,["modelValue"]),o(U,{modelValue:_.value,"onUpdate:modelValue":s[6]||(s[6]=d=>_.value=d)},{default:n(()=>[o(X,{order:y.value,onClose:s[5]||(s[5]=d=>_.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",$e,[Ue,e("div",Re,[Se,e("div",Le,[Pe,e("div",qe,[Qe,f(" Yes, I built both the frontend and backend by myself. Click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:s[7]||(s[7]=d=>w.$router.push("/project-details"))},"here"),f(" to see the details of how I built this. I initially thought it would be a simple website, but it became much more complicated and cost me a lot of time. ðŸ«  If you'd like to give me some advice, just click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:s[8]||(s[8]=d=>w.$router.push("/feedback"))},"here"),f(". Thank you! ")])]),e("div",{class:"qa-item"},[Ne,e("div",{class:"a-text"},[ze,f(" Yes, but not yet. It's still in the beta phase. You can click "),e("span",{class:"clickable-text",onClick:J},"here"),f(" to explore the menu editor, but you can't save changes to the backend yet. ")])])])])]),_:1})}}}),je=N(De,[["__scopeId","data-v-b58ef1f9"]]);export{je as default};
