import{a8 as ee,r as v,a9 as te,d as L,a as B,c as j,i as k,y as C,w as r,f as s,G as b,e,aa as V,B as $,ab as E,E as x,ac as oe,V as w,p as R,k as P,_ as Q,ad as se,S as ae,o as le,g as z,D,A as I,R as Z,ae as A,j as f}from"./index-CPEq9adi.js";import{Q as ne}from"./QPage-CtcwiLds.js";import{d as T,l as O}from"./MomPosMainPageDark-BsLCBqY-.js";const re=ee("user",()=>{const i=v(null);return{user:i,fetchUserInfo:async u=>{try{const m=await te(u);i.value=m}catch(m){console.error("Error fetching user info:",m)}},logout:()=>{i.value=null}}}),ie=i=>(R("data-v-4777f04c"),i=i(),P(),i),ue=ie(()=>e("div",{class:"text-h6 text-center"},"Register",-1)),ce={class:"flex-center"},de=["src"],me=L({__name:"RegisterComponent",setup(i){const t=v(""),l=v(""),u=v(""),m=B(),h=j(()=>m.isDarkMode?T:O),p=async()=>{const o=(()=>{let n="";return(t.value.length<6||t.value.length>20)&&(n+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(n+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(n+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(n+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(n+='Account must not include reserved words like "admin" or "root". '),(l.value.length<8||l.value.length>20)&&(n+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(l.value)||!/\d/.test(l.value))&&(n+="Password must include both letters and numbers. "),n})();if(o){w.create({type:"negative",message:o.trim()});return}try{await oe({account:t.value,password:l.value,name:u.value}),w.create({type:"positive",message:"Registration successful! Please login now"}),setTimeout(()=>{window.location.reload()},2e3)}catch(n){w.create({type:"negative",message:n.message||"Registration failed. Please try again."})}};return(c,o)=>(k(),C(x,{class:"rounded-borders"},{default:r(()=>[s(b,null,{default:r(()=>[ue]),_:1}),s(b,null,{default:r(()=>[e("div",ce,[e("img",{src:h.value,"spinner-color":"white",class:"login-image"},null,8,de)]),s(V,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=n=>u.value=n),label:"User Name",outlined:"",dense:""},null,8,["modelValue"]),s(V,{modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=n=>t.value=n),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),s(V,{modelValue:l.value,"onUpdate:modelValue":o[2]||(o[2]=n=>l.value=n),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),s(E,{align:"center",class:"card-margin"},{default:r(()=>[s($,{label:"Register",color:"primary",onClick:p,disable:!t.value||!l.value||!u.value},null,8,["disable"]),s($,{label:"Back to Login",color:"secondary",onClick:o[3]||(o[3]=n=>c.$emit("open-login"))})]),_:1})]),_:1}))}}),ve=Q(me,[["__scopeId","data-v-4777f04c"]]),Y=i=>(R("data-v-1f7302fd"),i=i(),P(),i),fe=Y(()=>e("div",{class:"text-h6 text-center"},"Welcome!",-1)),pe={class:"flex-center"},ge=["src"],he={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},_e=Y(()=>e("div",null,"Do not have account?",-1)),be=L({__name:"LoginComponent",setup(i){const t=v(""),l=v(""),u=B(),m=async()=>{const c=(()=>{let o="";return(t.value.length<6||t.value.length>20)&&(o+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(o+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(o+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(o+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(o+='Account must not include reserved words like "admin" or "root". '),(l.value.length<8||l.value.length>20)&&(o+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(l.value)||!/\d/.test(l.value))&&(o+="Password must include both letters and numbers. "),o})();if(c){w.create({type:"negative",message:c.trim()});return}try{await se({account:t.value,password:l.value}),w.create({type:"positive",message:"Login successful!"})}catch(o){w.create({type:"negative",message:o.message||"Login failed. Please try again."})}},h=j(()=>u.isDarkMode?T:O);return(p,c)=>(k(),C(x,{class:"rounded-borders"},{default:r(()=>[s(b,null,{default:r(()=>[fe]),_:1}),s(b,null,{default:r(()=>[e("div",pe,[e("img",{src:h.value,"spinner-color":"white",class:"login-image"},null,8,ge)]),e("div",he,[_e,e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:c[0]||(c[0]=o=>p.$emit("open-register"))}," Click For Register! ")]),s(V,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=o=>t.value=o),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),s(V,{modelValue:l.value,"onUpdate:modelValue":c[2]||(c[2]=o=>l.value=o),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),s(E,{align:"center"},{default:r(()=>[s($,{label:"Login",color:"primary",disable:!t.value||!l.value,onClick:m,class:"login-button"},null,8,["disable"])]),_:1})]),_:1}))}}),we=Q(be,[["__scopeId","data-v-1f7302fd"]]),g=i=>(R("data-v-b58ef1f9"),i=i(),P(),i),ye={class:"user-page-container"},ke={class:"q-ml-md"},Ce={class:"text-h6",style:{"font-weight":"700"}},Ve=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Logout",-1)),xe=g(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Login",-1)),Ie={class:"qa-container beautiful-shadow"},Ae=g(()=>e("div",{class:"text-h6 flex flex-center qa-title"},"Q & A",-1)),$e={class:"qa-list"},Ue=g(()=>e("div",{class:"qa-item"},[e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Will you reveal my password? ")]),e("div",{class:"a-text"},[e("strong",null,"A:"),f(" No. I use PasswordHasher in .NET Core, so your password is securely hashed and never actually stored in the database. Don't worry. You can also just use a fake password to register. ")])],-1)),Se={class:"qa-item"},Le=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Did you build this on your own? ")],-1)),Re={class:"a-text"},Pe=g(()=>e("strong",null,"A:",-1)),Qe=g(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),f(" Can I become a shopper to build my own menu? ")],-1)),qe=g(()=>e("strong",null,"A:",-1)),Ne=L({__name:"UserPage",setup(i){const t=ae(),l=re(),u=v(!1),m=v(!1),h=v(!1),p=v(!1),c=v(null),o=()=>{m.value=!1,u.value=!0},n=()=>{u.value=!1,m.value=!0},M=()=>{u.value=!1},F=()=>{m.value=!1},G=()=>{confirm("Are you sure you want to logout?")&&(l.logout(),t.cookies.remove("token"),t.cookies.remove("permission"),t.cookies.remove("userId"),U=!1,window.location.href="/user")},W=()=>{u.value=!0};let U=!1;function S(_){const a=document.cookie.match(new RegExp("(^|;\\s*)"+_+"=([^;]*)"));return a?decodeURIComponent(a[2]):null}const q=S("token"),N=S("userId"),y=S("permission"),H=y==null?void 0:y.toUpperCase();console.log(q);const J=()=>{t.cookies.remove("permission"),t.cookies.set("permission","admin",{path:"/",expires:1}),window.location.href=`${window.location.origin}/#/menu-editor`,setTimeout(()=>{window.location.reload()},2e3)};return le(async()=>{var _;if(console.log("yooo"),!q||!N){u.value=!0;return}if(!U)try{await l.fetchUserInfo(parseInt(N)),U=!0}catch(a){((_=a.response)==null?void 0:_.status)===401?u.value=!0:console.error("Unexpected error:",a)}}),(_,a)=>{const K=z("user-profile-component"),X=z("user-history-order-component");return k(),C(ne,{class:"q-pa-md flex flex-center"},{default:r(()=>[e("div",ye,[s(x,{class:"user-profile-bar"},{default:r(()=>[s(b,{class:"row items-center"},{default:r(()=>{var d;return[s($,{flat:"",round:"",onClick:a[0]||(a[0]=()=>{}),icon:"fas fa-user"}),e("div",ke,[e("div",Ce,D(((d=I(l).user)==null?void 0:d.userName)||"Guest"),1),e("div",null,D(I(H)||"Not logged in"),1)])]}),_:1})]),_:1}),I(y)?(k(),C(x,{key:0,class:"logout-bar",onClick:G},{default:r(()=>[s(b,{class:"logout-text"},{default:r(()=>[Ve]),_:1})]),_:1})):Z("",!0),I(y)?Z("",!0):(k(),C(x,{key:1,class:"logout-bar",onClick:W},{default:r(()=>[s(b,{class:"logout-text"},{default:r(()=>[xe]),_:1})]),_:1})),s(A,{modelValue:u.value,"onUpdate:modelValue":a[1]||(a[1]=d=>u.value=d)},{default:r(()=>[s(we,{onOpenRegister:n,onClose:M})]),_:1},8,["modelValue"]),s(A,{modelValue:m.value,"onUpdate:modelValue":a[2]||(a[2]=d=>m.value=d)},{default:r(()=>[s(ve,{onOpenLogin:o,onClose:F})]),_:1},8,["modelValue"]),s(A,{modelValue:h.value,"onUpdate:modelValue":a[4]||(a[4]=d=>h.value=d)},{default:r(()=>[s(K,{onClose:a[3]||(a[3]=d=>h.value=!1)})]),_:1},8,["modelValue"]),s(A,{modelValue:p.value,"onUpdate:modelValue":a[6]||(a[6]=d=>p.value=d)},{default:r(()=>[s(X,{order:c.value,onClose:a[5]||(a[5]=d=>p.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",Ie,[Ae,e("div",$e,[Ue,e("div",Se,[Le,e("div",Re,[Pe,f(" Yes, I built both the frontend and backend by myself. Click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:a[7]||(a[7]=d=>_.$router.push("/project-details"))},"here"),f(" to see the details of how I built this. I initially thought it would be a simple website, but it became much more complicated and cost me a lot of time. ðŸ«  If you'd like to give me some advice, just click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:a[8]||(a[8]=d=>_.$router.push("/feedback"))},"here"),f(". Thank you! ")])]),e("div",{class:"qa-item"},[Qe,e("div",{class:"a-text"},[qe,f(" Yes, but not yet. It's still in the beta phase. You can click "),e("span",{class:"clickable-text",onClick:J},"here"),f(" to explore the menu editor, but you can't save changes to the backend yet. ")])])])])]),_:1})}}}),Be=Q(Ne,[["__scopeId","data-v-b58ef1f9"]]);export{Be as default};
