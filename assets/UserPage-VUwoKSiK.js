import{a9 as X,r as p,aa as ee,d as P,a as T,c as j,e as V,z as x,w as n,i as o,C as b,g as e,ab as A,D as L,ac as E,E as I,ad as te,W as k,p as R,l as q,_ as Q,R as oe,v as se,ae,U as le,af as ne,o as re,b as N,B as D,j as $,S as Z,ag as U,k as g,ah as B}from"./index-Y9HiDaL1.js";import{Q as ue}from"./QPage-LCFnc6ey.js";import{d as O,l as Y}from"./MomPosMainPageDark-BsLCBqY-.js";const ie=X("user",()=>{const r=p(null);return{user:r,fetchUserInfo:async u=>{try{const m=await ee(u);r.value=m}catch(m){console.error("Error fetching user info:",m)}},logout:()=>{r.value=null}}}),ce=r=>(R("data-v-4777f04c"),r=r(),q(),r),de=ce(()=>e("div",{class:"text-h6 text-center"},"Register",-1)),me={class:"flex-center"},ve=["src"],pe=P({__name:"RegisterComponent",setup(r){const t=p(""),s=p(""),u=p(""),m=T(),_=j(()=>m.isDarkMode?O:Y),y=async()=>{const c=(()=>{let a="";return(t.value.length<6||t.value.length>20)&&(a+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(a+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(a+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(a+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(a+='Account must not include reserved words like "admin" or "root". '),(s.value.length<8||s.value.length>20)&&(a+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(s.value)||!/\d/.test(s.value))&&(a+="Password must include both letters and numbers. "),a})();if(c){k.create({type:"negative",message:c.trim()});return}try{await te({account:t.value,password:s.value,name:u.value}),k.create({type:"positive",message:"Registration successful! Please login now"}),setTimeout(()=>{window.location.reload()},2e3)}catch(a){k.create({type:"negative",message:a.message||"Registration failed. Please try again."})}};return(w,c)=>(V(),x(I,{class:"rounded-borders"},{default:n(()=>[o(b,null,{default:n(()=>[de]),_:1}),o(b,null,{default:n(()=>[e("div",me,[e("img",{src:_.value,"spinner-color":"white",class:"login-image"},null,8,ve)]),o(A,{modelValue:u.value,"onUpdate:modelValue":c[0]||(c[0]=a=>u.value=a),label:"User Name",outlined:"",dense:""},null,8,["modelValue"]),o(A,{modelValue:t.value,"onUpdate:modelValue":c[1]||(c[1]=a=>t.value=a),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),o(A,{modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=a=>s.value=a),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),o(E,{align:"center",class:"card-margin"},{default:n(()=>[o(L,{label:"Register",color:"primary",onClick:y,disable:!t.value||!s.value||!u.value},null,8,["disable"]),o(L,{label:"Back to Login",color:"secondary",onClick:c[3]||(c[3]=a=>w.$emit("open-login"))})]),_:1})]),_:1}))}}),ge=Q(pe,[["__scopeId","data-v-4777f04c"]]),M=r=>(R("data-v-2fd64e32"),r=r(),q(),r),fe=M(()=>e("div",{class:"text-h6 text-center"},"Welcome!",-1)),he={class:"flex-center"},_e=["src"],ye={style:{"font-size":"1rem","text-align":"center","margin-bottom":"1rem"}},be=M(()=>e("div",null,"Do not have account?",-1)),we=P({__name:"LoginComponent",setup(r){const t=p(""),s=p(""),u=oe(),m=se(),_=typeof u.query.from=="string"?u.query.from:"/",y=T(),w=async()=>{const v=(()=>{let i="";return(t.value.length<6||t.value.length>20)&&(i+="Account must be 6-20 characters long. "),/^[a-zA-Z0-9._]+$/.test(t.value)||(i+='Account must not include special characters other than "." and "_". '),/[_\.]{2,}/.test(t.value)&&(i+="Account must not include consecutive special characters. "),(!/^[a-zA-Z0-9]/.test(t.value)||!/[a-zA-Z0-9]$/.test(t.value))&&(i+="Account must start and end with a letter or number. "),/\b(admin|root)\b/.test(t.value)&&(i+='Account must not include reserved words like "admin" or "root". '),(s.value.length<8||s.value.length>20)&&(i+="Password must be 8-20 characters long. "),(!/[a-zA-Z]/.test(s.value)||!/\d/.test(s.value))&&(i+="Password must include both letters and numbers. "),i})();if(v){k.create({type:"negative",message:v.trim()});return}try{await ae({account:t.value,password:s.value}),k.create({type:"positive",message:"Login successful!"}),m.push(_),setTimeout(()=>{window.location.reload()},0)}catch(i){k.create({type:"negative",message:i.message||"Login failed. Please try again."})}},c=j(()=>y.isDarkMode?O:Y);return(a,v)=>(V(),x(I,{class:"rounded-borders"},{default:n(()=>[o(b,null,{default:n(()=>[fe]),_:1}),o(b,null,{default:n(()=>[e("div",he,[e("img",{src:c.value,"spinner-color":"white",class:"login-image"},null,8,_e)]),e("div",ye,[be,e("div",{style:{color:"#FDA300",cursor:"pointer","font-weight":"bold"},onClick:v[0]||(v[0]=i=>a.$emit("open-register"))}," Click For Register! ")]),o(A,{modelValue:t.value,"onUpdate:modelValue":v[1]||(v[1]=i=>t.value=i),label:"Account",outlined:"",dense:""},null,8,["modelValue"]),o(A,{modelValue:s.value,"onUpdate:modelValue":v[2]||(v[2]=i=>s.value=i),label:"Password",type:"password",outlined:"",dense:""},null,8,["modelValue"])]),_:1}),o(E,{align:"center"},{default:n(()=>[o(L,{label:"Login",color:"primary",disable:!t.value||!s.value,onClick:w,class:"login-button"},null,8,["disable"])]),_:1})]),_:1}))}}),ke=Q(we,[["__scopeId","data-v-2fd64e32"]]),h=r=>(R("data-v-3335aee8"),r=r(),q(),r),Ce={class:"user-page-container"},Ve={class:"q-ml-md"},xe={class:"text-h6",style:{"font-weight":"700"}},Ae=h(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Logout",-1)),Ie=h(()=>e("div",{class:"text-h6",style:{"font-weight":"700"}},"Login",-1)),$e={class:"qa-container beautiful-shadow"},Ue=h(()=>e("div",{class:"text-h6 flex flex-center qa-title"},"Q & A",-1)),Le={class:"qa-list"},Se=h(()=>e("div",{class:"qa-item"},[e("div",{class:"q-text"},[e("strong",null,"Q:"),g(" Will you reveal my password? ")]),e("div",{class:"a-text"},[e("strong",null,"A:"),g(" No. I use PasswordHasher in .NET Core, so your password is securely hashed and never actually stored in the database. Don't worry. You can also just use a fake password to register. ")])],-1)),Pe={class:"qa-item"},Re=h(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),g(" Did you build this on your own? ")],-1)),qe={class:"a-text"},Qe=h(()=>e("strong",null,"A:",-1)),ze=h(()=>e("div",{class:"q-text"},[e("strong",null,"Q:"),g(" Can I become a shopper to build my own menu? ")],-1)),Ne=h(()=>e("strong",null,"A:",-1)),De=P({__name:"UserPage",setup(r){var z;const t=le(),s=ie(),u=p(!1),m=p(!1),_=p(!1),y=p(!1),w=p(null),c=()=>{m.value=!1,u.value=!0},a=()=>{u.value=!1,m.value=!0},v=()=>{u.value=!1},i=()=>{m.value=!1},W=()=>{t.dialog({title:"Confirm Logout",message:"Are you sure you want to logout?",ok:{label:"Logout",color:"primary"},cancel:{label:"Cancel",color:"primary",outline:!0},persistent:!0}).onOk(()=>{s.logout(),f.logout(),S=!1,B.push("/"),t.notify({color:"secondary",message:"You have logged out successfully."})}).onCancel(()=>{t.notify({color:"primary",message:"Logout canceled."})})},F=()=>{u.value=!0};let S=!1;const f=ne(),G=(z=f.permission)==null?void 0:z.toUpperCase(),H=()=>{f.setPermission("admin"),B.push("/menu-editor")};return re(async()=>{var C;if(!f.permission||!f.userId){u.value=!0;return}if(!S)try{await s.fetchUserInfo(parseInt(f.userId)),S=!0}catch(l){((C=l.response)==null?void 0:C.status)===401?u.value=!0:console.error("Unexpected error:",l)}}),(C,l)=>{const J=N("user-profile-component"),K=N("user-history-order-component");return V(),x(ue,{class:"q-pa-md flex flex-center"},{default:n(()=>[e("div",Ce,[o(I,{class:"user-profile-bar"},{default:n(()=>[o(b,{class:"row items-center"},{default:n(()=>{var d;return[o(L,{flat:"",round:"",onClick:l[0]||(l[0]=()=>{}),icon:"fas fa-user"}),e("div",Ve,[e("div",xe,D(((d=$(s).user)==null?void 0:d.userName)||"Guest"),1),e("div",null,D($(G)||"Not logged in"),1)])]}),_:1})]),_:1}),$(f).permission?(V(),x(I,{key:0,class:"logout-bar",onClick:W},{default:n(()=>[o(b,{class:"logout-text"},{default:n(()=>[Ae]),_:1})]),_:1})):Z("",!0),$(f).permission?Z("",!0):(V(),x(I,{key:1,class:"logout-bar",onClick:F},{default:n(()=>[o(b,{class:"logout-text"},{default:n(()=>[Ie]),_:1})]),_:1})),o(U,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=d=>u.value=d)},{default:n(()=>[o(ke,{onOpenRegister:a,onClose:v})]),_:1},8,["modelValue"]),o(U,{modelValue:m.value,"onUpdate:modelValue":l[2]||(l[2]=d=>m.value=d)},{default:n(()=>[o(ge,{onOpenLogin:c,onClose:i})]),_:1},8,["modelValue"]),o(U,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=d=>_.value=d)},{default:n(()=>[o(J,{onClose:l[3]||(l[3]=d=>_.value=!1)})]),_:1},8,["modelValue"]),o(U,{modelValue:y.value,"onUpdate:modelValue":l[6]||(l[6]=d=>y.value=d)},{default:n(()=>[o(K,{order:w.value,onClose:l[5]||(l[5]=d=>y.value=!1)},null,8,["order"])]),_:1},8,["modelValue"])]),e("div",$e,[Ue,e("div",Le,[Se,e("div",Pe,[Re,e("div",qe,[Qe,g(" Yes, I built both the frontend and backend by myself. Click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:l[7]||(l[7]=d=>C.$router.push("/project-details"))},"here"),g(" to see the details of how I built this. I initially thought it would be a simple website, but it became much more complicated and cost me a lot of time. ðŸ«  If you'd like to give me some advice, just click "),e("a",{href:"javascript:void(0)",class:"clickable-link",onClick:l[8]||(l[8]=d=>C.$router.push("/feedback"))},"here"),g(". Thank you! ")])]),e("div",{class:"qa-item"},[ze,e("div",{class:"a-text"},[Ne,g(" Yes, but not yet. It's still in the beta phase. You can click "),e("span",{class:"clickable-text",onClick:H},"here"),g(" to explore the menu editor, but you can't save changes to the backend yet. ")])])])])]),_:1})}}}),je=Q(De,[["__scopeId","data-v-3335aee8"]]);export{je as default};
